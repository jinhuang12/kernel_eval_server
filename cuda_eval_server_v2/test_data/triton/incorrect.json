{
  "name": "incorrect_add",
  "request": {
    "ref_kernel": {
      "source_code": "\nimport torch\nimport torch.nn as nn\n\nclass Model(nn.Module):\n    def __init__(self):\n        super().__init__()\n\n    def forward(self, x, y):\n        return x + y\n\ndef get_init_inputs():\n    return []\n\ndef get_inputs():\n    x = torch.randn(2048, device='cuda')\n    y = torch.randn(2048, device='cuda')\n    return [x, y]\n",
      "kernel_type": "torch",
      "io": null,
      "metadata": null
    },
    "custom_kernel": {
      "source_code": "\nimport torch\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef add_kernel(x_ptr, y_ptr, output_ptr, n_elements, BLOCK_SIZE: tl.constexpr):\n    pid = tl.program_id(axis=0)\n    block_start = pid * BLOCK_SIZE\n    offsets = block_start + tl.arange(0, BLOCK_SIZE)\n    mask = offsets < n_elements\n    x = tl.load(x_ptr + offsets, mask=mask, other=0.0)\n    y = tl.load(y_ptr + offsets, mask=mask, other=0.0)\n    # Intentional bug: subtract instead of add\n    tl.store(output_ptr + offsets, x - y, mask=mask)\n",
      "kernel_type": "triton",
      "io": {
        "args": [
          {
            "name": "x_ptr",
            "type": "tensor",
            "value": null,
            "tensor_spec": {
              "shape": [
                2048
              ],
              "dtype": "float32",
              "init": {
                "kind": "randn",
                "seed": 0,
                "mean": null,
                "std": null,
                "low": null,
                "high": null,
                "fill_value": null,
                "start": null,
                "step": null
              },
              "data": null
            },
            "role": "input",
            "is_meta": false
          },
          {
            "name": "y_ptr",
            "type": "tensor",
            "value": null,
            "tensor_spec": {
              "shape": [
                2048
              ],
              "dtype": "float32",
              "init": {
                "kind": "randn",
                "seed": 1,
                "mean": null,
                "std": null,
                "low": null,
                "high": null,
                "fill_value": null,
                "start": null,
                "step": null
              },
              "data": null
            },
            "role": "input",
            "is_meta": false
          },
          {
            "name": "output_ptr",
            "type": "tensor",
            "value": null,
            "tensor_spec": {
              "shape": [
                2048
              ],
              "dtype": "float32",
              "init": null,
              "data": null
            },
            "role": "output",
            "is_meta": false
          },
          {
            "name": "n_elements",
            "type": "int",
            "value": 2048,
            "tensor_spec": null,
            "role": "input",
            "is_meta": false
          },
          {
            "name": "BLOCK_SIZE",
            "type": "int",
            "value": 512,
            "tensor_spec": null,
            "role": "input",
            "is_meta": true
          }
        ],
        "outputs": [
          {
            "shape": [
              2048
            ],
            "dtype": "float32",
            "init": null,
            "data": null
          }
        ],
        "launch": {
          "grid": {
            "x": 4,
            "y": 1,
            "z": 1
          },
          "block": null,
          "shared_mem_bytes": null,
          "num_warps": 4,
          "num_stages": null
        }
      },
      "metadata": null
    },
    "num_trials": 5,
    "timeout": 120
  },
  "expected": {
    "status": "success",
    "is_correct": false
  }
}