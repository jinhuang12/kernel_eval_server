{
  "ref_kernel": {
    "source_code": "\nimport torch\nimport torch.nn as nn\n\nclass Model(nn.Module):\n    def __init__(self):\n        super().__init__()\n    \n    def forward(self, x):\n        return torch.nn.functional.gelu(x)\n",
    "kernel_type": "torch",
    "io": {
      "args": [
        {
          "name": "x",
          "type": "tensor",
          "role": "input",
          "tensor_spec": {
            "shape": [1024, 1024],
            "dtype": "float32",
            "init": {
              "kind": "randn",
              "seed": 42
            }
          }
        }
      ]
    }
  },
  "custom_kernel": {
    "source_code": "__global__ void gelu_activation(float* input, float* output, int n_elements) {\n    int tid = blockIdx.x * blockDim.x + threadIdx.x;\n    if (tid < n_elements) {\n        float x = input[tid];\n        float x3 = x * x * x;\n        float inner = 0.7978845608f * (x + 0.044715f * x3);\n        float exp2x = expf(2.0f * inner);\n        float tanh_val = (exp2x - 1.0f) / (exp2x + 1.0f);\n        output[tid] = x * 0.5f * (1.0f + tanh_val);\n    }\n}",
    "kernel_type": "cuda",
    "io": {
      "args": [
        {
          "name": "input",
          "type": "tensor",
          "role": "input",
          "tensor_spec": {
            "shape": [1024, 1024],
            "dtype": "float32",
            "init": {
              "kind": "randn",
              "seed": 42
            }
          }
        },
        {
          "name": "output",
          "type": "tensor",
          "role": "output",
          "tensor_spec": {
            "shape": [1024, 1024],
            "dtype": "float32",
            "init": {
              "kind": "zeros"
            }
          }
        },
        {
          "name": "n_elements",
          "type": "int",
          "role": "input",
          "value": 1048576
        }
      ],
      "launch": {
        "grid": {
          "x": 1024,
          "y": 1,
          "z": 1
        },
        "block": {
          "x": 1024,
          "y": 1,
          "z": 1
        }
      }
    },
    "metadata": {
      "kernel_name": "gelu_activation"
    }
  },
  "num_trials": 10,
  "timeout": 120
}